<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/home.ar.css">
    <link rel="stylesheet" href="./styles/home.button.css">
    <link rel="stylesheet" href="./styles/home.general.css">
    <link rel="stylesheet" href="./styles/home.map.css">
    <link rel="stylesheet" href="./styles/home.help-menu.css">
    <title>ARbiter</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

  </head>

  <style>
    body{
      margin: 0;
    }
    canvas{
      background-color: transparent;
    }
  </style>

  <body>
    <a-scene embedded arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;">
      <a-marker-camera preset="custom" type="pattern" url="./tags/patt/pattern-tag25h9-2.patt"></a-marker-camera>
      <a-entity camera position="0 0 5" near="0.1" far="1000"></a-entity> 
    </a-scene>

    <div class="ui-container">
      <div class="ui-button-container">
        <button class="ui-button" onclick="switchFloor(1)">
          <img src="./images/icons/map.png" alt="First Floor" class="map-icon" />
          First Floor
        </button>
      </div>
      <div>
        <button class="ui-button" onclick="switchFloor(2)">
          <img src="./images/icons/map.png" alt="Ground Floor" class="map-icon" />
          Ground Floor
        </button>
      </div>
    </div>
  </body>
    <script>
      var firstFloor = new THREE.TextureLoader();
      var groundFloor = new THREE.TextureLoader();
      
      var firstFloorPlane;
      var groundFloorPlane;

      firstFloor.load('./js/first_floor.png', function(texture) {
        var geometry = new THREE.PlaneGeometry(10, 5);
        var material = new THREE.MeshBasicMaterial({ map: texture, side: THREE.DoubleSide });
        firstFloorPlane = new THREE.Mesh(geometry, material);
        firstFloorPlane.position.set(0, 0, 0);
        firstFloorPlane.scale.set(2.5, 2.5, 2.5);
        firstFloorPlane.rotation.x = -Math.PI / 2;
        
        var marker = document.querySelector('a-marker-camera');
        if (marker) {
          marker.object3D.add(firstFloorPlane);
          console.log('First floor added');
        } else {
          console.log('No marker found');
        }
      });

      groundFloor.load('./js/ground_floor.png', function(texture) {
        var geometry = new THREE.PlaneGeometry(10, 5);
        var material = new THREE.MeshBasicMaterial({ map: texture, side: THREE.DoubleSide });
        groundFloorPlane = new THREE.Mesh(geometry, material);
        groundFloorPlane.position.set(0, 0, 0);
        groundFloorPlane.scale.set(2.5, 2.5, 2.5);
        groundFloorPlane.rotation.x = -Math.PI / 2;
        
        var marker = document.querySelector('a-marker-camera');
        if (marker) {
          marker.object3D.add(groundFloorPlane);
          console.log('Ground floor added');
        } else {
          console.log('No marker found');
        }
      });

      function switchFloor(floor) {
        if (floor === 1) {
          if (firstFloorPlane) firstFloorPlane.visible = true;
          if (groundFloorPlane) groundFloorPlane.visible = false;
        } else if (floor === 2) {
          if (firstFloorPlane) firstFloorPlane.visible = false;
          if (groundFloorPlane) groundFloorPlane.visible = true;
        }
      }

    </script>
</html>
